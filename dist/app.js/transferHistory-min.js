const base_url="https://imdcurrency.herokuapp.com";localStorage.getItem("token")||(window.location.href="../login/login.html"),primus=Primus.connect(base_url,{reconnect:{max:1/0,min:500,retries:10}}),primus.on("data",e=>{"updated balance counter"===e.action&&appendTransfers()});let fullname,appendTransfers=()=>{fetch(base_url+"/api/v1/transfers",{method:"get",headers:{"content-type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(e=>{let a=document.querySelector(".list");a.innerHTML="",e.data.transactions.forEach(e=>{if(e.sender==fullname)var t=e.receiver,n="transfer__amount--send",r="-";else t=e.sender,n="transfer__amount--received",r="+";let s=`<a class="link" href="./transferDetail.html?detail=${e._id}"><div class="list__row"> \n            <div class="avatar"></div>\n            <div class="list__name"><p>`+t+`</p></div>\n           <p class="list__balance list__balance--right"><span class="${n}">${r} ${e.amount}</span></p></div>\n            </a>`;a.insertAdjacentHTML("afterbegin",s)})}).catch(e=>{console.log(e)})};fetch(base_url+"/api/v1/transfers/user",{method:"get",headers:{"content-type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(e=>{fullname=e.user.fullname,appendTransfers()}).catch(e=>{console.log(e)});